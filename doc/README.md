# 婚庆管家 - 新项目开发文档

## 项目信息

- **项目名称**: 婚庆管家（Wedding Host Manager）
- **版本**: v1.0.0
- **目标平台**: 微信小程序
- **技术栈**: ThinkPHP 8.0 + uni-app + Vue 3

---

## 文档目录

### 核心文档（必读）

| 序号 | 文档名称 | 说明 | 包含内容 |
|-----|---------|------|---------|
| 01 | [项目开发文档](./01-项目开发文档.md) | 技术架构、开发规范、架构优化 | 项目概述、技术架构、目录结构、开发规范、环境配置、架构优化方案（服务抽象层、缓存策略、订单超时处理、DIY功能） |
| 02 | [数据库设计文档](./02-数据库设计文档.md) | 数据库设计、索引优化 | 所有表结构、字段说明、索引设计、数据迁移脚本、架构优化说明 |
| 03 | [API接口设计文档](./03-API接口设计文档.md) | API接口定义 | 所有API接口定义、请求参数、响应格式、接口规范 |
| 04 | [业务流程文档](./04-业务流程文档.md) | 业务流程、功能设计 | 核心业务流程、订单状态流转、角色权限详细说明、多服务类型筛选与预约设计、购物车功能设计 |
| 05 | [开发计划文档](./05-开发计划文档.md) | 开发计划 | 开发阶段划分、任务清单、里程碑节点 |

### 数据库脚本

| 序号 | 文档名称 | 说明 |
|-----|---------|------|
| 06 | [初始化SQL脚本](./06-初始化SQL脚本.sql) | 数据库初始化脚本（**需根据数据库设计文档更新**） |

**重要说明**: 
- 所有表结构以 `02-数据库设计文档.md` 为准
- `06-初始化SQL脚本.sql` 需要根据数据库设计文档更新
- 统一使用 `wedding_service_provider` 表，不再保留 `wedding_host` 表

---

## 快速开始

### 1. 后端项目初始化

```bash
# 创建项目
composer create-project topthink/think Wedding-management-api

# 进入目录
cd Wedding-management-api

# 安装依赖
composer require firebase/php-jwt
composer require topthink/think-filesystem

# 配置数据库
cp .example.env .env
# 编辑 .env 文件配置数据库连接

# 创建数据库并导入表结构
# 注意：请根据 02-数据库设计文档.md 中的表结构生成SQL脚本
mysql -u root -p < database/Wedding_management.sql

# 启动开发服务器
php think run
```

### 2. 小程序项目初始化

```bash
# 创建项目
npx degit dcloudio/uni-preset-vue#vite-ts Wedding-management-miniapp

# 进入目录
cd Wedding-management-miniapp

# 安装依赖
npm install

# 安装 UI 组件库
npm install tuniao-ui

# 配置 tuniao UI V3
# 在 main.ts 中引入并注册
# import { createApp } from 'vue'
# import App from './App.vue'
# import tuniaoUI from 'tuniao-ui'
# import 'tuniao-ui/index.scss'
# 
# const app = createApp(App)
# app.use(tuniaoUI)
# app.mount('#app')
#
# 详细配置请参考 tuniao UI V3 官方文档：
# https://www.tuniao.tech/

# 配置环境变量
cp .env.development.example .env.development

# 启动开发
npm run dev:mp-weixin
```

### 3. 管理端项目初始化

```bash
# 创建项目
npm create vite@latest Wedding-management-admin -- --template vue-ts

# 进入目录
cd Wedding-management-admin

# 安装依赖
npm install
npm install element-plus
npm install tailwindcss autoprefixer postcss
npm install vuedraggable@next  # DIY装修拖拽库
npm install pinia vue-router axios

# 启动开发
npm run dev
```

---

## 核心功能

### 小程序功能（统一应用，按角色区分）

**所有用户**:
- 服务类型选择（主持人/跟拍/管家）
- 服务提供者浏览与搜索（支持多类型筛选）
- 服务提供者详情查看
- 档期查询与选择
- 动态浏览、点赞、评论

**普通用户**:
- 购物车功能（支持多选不同服务类型、场次、套餐）
- 统一预约下单（支持所有服务类型，支持购物车批量结算）
- 订单管理（我的订单，支持按服务类型筛选）
- 评价管理（提交评价）
- 收藏功能（支持所有服务类型）

**服务提供者**（主持人/跟拍/管家）:
- 工作台数据统计
- 订单审核（同意/拒绝）
- 服务确认完成
- 档期管理
- 动态发布与管理
- 评价回复

### 管理端功能（PC端）
- 服务类型管理
- 服务提供者管理（支持所有服务类型）
- 订单管理（支持按服务类型筛选）
- 付款确认（凭证上传）
- 退款处理（凭证上传）
- 评价审核
- 动态审核
- 系统配置

---

## 业务流程概述

### 订单流程

```
用户下单 → 待审核 → 主持人审核 → 已同意/已拒绝
                          ↓
                      管理员确认付款
                          ↓
                      已付款 → 待服务
                          ↓
                      服务完成 → 已完成
```

### 退款流程

```
用户申请退款 → 退款审核中 → 管理员审核
                              ↓
                     同意：上传退款凭证 → 已退款
                     拒绝：恢复原状态
```

---

## 技术特点

1. **不依赖框架**: 纯净的ThinkPHP后端，无需niucloud框架
2. **无支付集成**: 采用凭证上传模式，管理员人工确认
3. **单站点模式**: 不支持多站点，简化数据结构
4. **统一小程序**: 小程序端为统一应用，通过用户角色判断显示不同功能
5. **角色权限控制**: 前端路由守卫 + 后端中间件双重验证
6. **现代化UI**: 使用 tuniao UI V3 组件库，提供丰富的组件和良好的用户体验

---

## 开发周期

- **预计开发周期**: 5周
- **第1周**: 项目搭建、数据库、基础接口
- **第2周**: 主持人模块、订单模块
- **第3周**: 评价、动态、退款模块
- **第4周**: 小程序、管理端前端开发
- **第5周**: 测试、优化、部署上线

---

## 文档使用说明

### 开发前必读（按顺序阅读）
1. **项目开发文档** - 了解技术架构、目录结构、开发规范、架构优化方案
2. **数据库设计文档** - 了解表结构、字段定义、索引设计、优化说明
3. **API接口设计文档** - 了解接口规范和参数定义
4. **业务流程文档** - 了解业务逻辑、状态流转、角色权限、多服务类型设计、购物车功能
5. **开发计划文档** - 了解开发阶段和任务分配

### 开发流程建议
1. **项目启动**: 阅读核心文档（01-05），了解项目全貌
2. **环境搭建**: 根据项目开发文档搭建开发环境
3. **数据库初始化**: 根据数据库设计文档创建表结构
4. **功能开发**: 根据业务流程文档和API接口文档开发功能
5. **性能优化**: 参考项目开发文档中的架构优化方案

## 重要说明

1. **数据库表结构**: 统一使用 `wedding_service_provider` 表，不再保留 `wedding_host` 表
2. **SQL脚本**: `06-初始化SQL脚本.sql` 需要根据 `02-数据库设计文档.md` 更新
3. **服务抽象层**: 参考 `11-架构优化方案.md` 实现统一的服务抽象层
4. **缓存策略**: 参考 `11-架构优化方案.md` 实现缓存机制

## 相关文档

- [原项目重构评估报告](../项目重构评估报告.md)
- [原项目代码审查报告](../代码审查与优化报告.md)

---

**最后更新**: 2025-01-01

