# 婚庆管家 - 开发计划文档

**项目名称**: 婚庆管家（Wedding Host Manager）  
**版本**: v1.0.0  
**创建日期**: 2025-12-31

---

## 一、项目概述

### 1.1 项目目标

基于ThinkPHP 8.0 + uni-app技术栈，开发一个专注微信小程序平台的婚庆主持人预约管理系统，包含用户端、主持人端和管理端三个应用入口。

### 1.2 核心特点

- 不依赖第三方框架，纯净的ThinkPHP后端
- 专注微信小程序，不做多端适配
- 不集成支付系统，采用凭证上传模式
- 不支持多站点，单站点运营

### 1.3 项目周期

- **预计开发周期**: 5周
- **开始日期**: 2025-01-06（周一）
- **预计完成**: 2025-02-07（周五）

---

## 二、开发阶段划分

### 2.1 阶段概览

| 阶段 | 名称 | 周期 | 主要内容 |
|-----|------|------|---------|
| 第1阶段 | 项目搭建 | 第1周 | 环境搭建、基础框架、数据库 |
| 第2阶段 | 核心功能 | 第2周 | 主持人模块、订单模块 |
| 第3阶段 | 扩展功能 | 第3周 | 评价、动态、退款模块 |
| 第4阶段 | 前端开发 | 第4周 | 小程序、管理端前端 |
| 第5阶段 | 测试上线 | 第5周 | 测试、优化、部署 |

---

## 三、第1阶段：项目搭建（第1周）

### 3.1 Day 1-2：环境搭建与项目初始化

**任务清单**:

- [ ] **后端项目初始化**
  - [ ] 创建ThinkPHP 8.0项目
  - [ ] 配置composer依赖
  - [ ] 配置数据库连接
  - [ ] 配置Redis缓存
  - [ ] 配置路由规则

- [ ] **前端项目初始化**
  - [ ] 创建uni-app项目
  - [ ] 配置TypeScript
  - [ ] 配置tuniao UI V3
  - [ ] 配置Pinia
  - [ ] 配置请求封装

- [ ] **管理端项目初始化**
  - [ ] 创建Vue3 + Vite项目
  - [ ] 配置Element Plus
  - [ ] 配置Tailwind CSS
  - [ ] 配置路由和状态管理

**验收标准**:
- 后端能正常启动并访问
- 小程序能在开发者工具中运行
- 管理端能在浏览器中访问

### 3.2 Day 3-4：数据库与模型层

**任务清单**:

- [ ] **数据库创建**
  - [ ] 创建数据库
  - [ ] 执行建表SQL
  - [ ] 插入初始数据

- [ ] **模型层开发**
  - [ ] Host模型
  - [ ] HostLabel模型
  - [ ] HostService模型
  - [ ] HostSchedule模型
  - [ ] HostFavorite模型
  - [ ] Order模型
  - [ ] OrderPeriod模型
  - [ ] OrderOption模型
  - [ ] OrderStatusLog模型
  - [ ] Review模型
  - [ ] RefundApply模型
  - [ ] Dynamic模型
  - [ ] DynamicComment模型
  - [ ] DynamicLike模型
  - [ ] DynamicCategory模型
  - [ ] Member模型
  - [ ] Admin模型
  - [ ] Config模型

**验收标准**:
- 所有表创建成功
- 模型能正常操作数据库

### 3.3 Day 5：认证中间件与基础接口

**任务清单**:

- [ ] **中间件开发**
  - [ ] CORS跨域中间件
  - [ ] API认证中间件（JWT）
  - [ ] 管理员认证中间件
  - [ ] 主持人认证中间件

- [ ] **基础接口开发**
  - [ ] 微信登录接口
  - [ ] 获取用户信息接口
  - [ ] 管理员登录接口
  - [ ] 文件上传接口
  - [ ] 配置获取接口

- [ ] **工具类开发**
  - [ ] JwtHelper
  - [ ] WechatHelper
  - [ ] UploadHelper
  - [ ] ResponseHelper

**验收标准**:
- 认证流程可正常工作
- 文件上传功能正常

---

## 四、第2阶段：核心功能（第2周）

### 4.1 Day 6-7：主持人模块

**任务清单**:

- [ ] **后端服务层**
  - [ ] ProviderService服务类（统一服务提供者服务）
  - [ ] ProviderLabelService服务类（标签服务，仅管理员可操作）
  - [ ] ProviderServiceService服务类（服务套餐服务）
  - [ ] ProviderScheduleService服务类（档期服务）
  - [ ] ProviderFavoriteService服务类（收藏服务）
  - [ ] ServiceProviderServiceFactory工厂类（服务抽象层）

- [ ] **后端控制器**
  - [ ] 管理端：Provider控制器（CRUD，统一接口，支持所有服务类型）
  - [ ] 管理端：ProviderLabel控制器（标签管理，仅管理员可操作）
  - [ ] API：Provider控制器（列表、详情、档期，统一接口）
  - [ ] API：Favorite控制器（收藏操作）

- [ ] **接口开发**
  - [ ] GET /admin/provider/list - 服务提供者列表（统一接口）
  - [ ] POST /admin/provider/add - 添加服务提供者（统一接口，支持设置标签）
  - [ ] POST /admin/provider/edit - 编辑服务提供者（统一接口，支持设置标签）
  - [ ] POST /admin/provider/delete - 删除服务提供者
  - [ ] GET /admin/provider/label/list - 标签列表（仅管理员）
  - [ ] POST /admin/provider/label/add - 添加标签（仅管理员）
  - [ ] POST /admin/provider/label/edit - 编辑标签（仅管理员）
  - [ ] POST /admin/provider/label/delete - 删除标签（仅管理员）
  - [ ] GET /api/provider/list - 服务提供者列表（统一接口）
  - [ ] GET /api/provider/info/{id} - 服务提供者详情（统一接口）
  - [ ] GET /api/provider/schedule/{id} - 服务提供者档期（统一接口）
  - [ ] GET /api/provider/labels - 标签列表（查询接口，所有用户可访问）
  - [ ] POST /api/provider/favorite - 收藏操作
  - [ ] GET /api/provider/favorites - 我的收藏

**验收标准**:
- 服务提供者CRUD功能正常（支持所有服务类型）
- 标签管理功能正常（仅管理员可操作）
- 档期查询功能正常
- 收藏功能正常

### 4.2 Day 8-10：订单模块

**任务清单**:

- [ ] **后端服务层**
  - [ ] OrderService服务类
    - [ ] createOrder方法（创建订单）
    - [ ] getList方法（订单列表）
    - [ ] getInfo方法（订单详情）
    - [ ] cancel方法（取消订单）
    - [ ] approve方法（同意订单）
    - [ ] reject方法（拒绝订单）
    - [ ] confirmPayment方法（确认付款）
    - [ ] confirmComplete方法（确认完成）
    - [ ] applyRefund方法（申请退款）
    - [ ] confirmRefund方法（确认退款）
  - [ ] OrderStatusLogService服务类

- [ ] **后端控制器**
  - [ ] API：Order控制器（统一接口，通过角色权限中间件区分）
  - [ ] Admin：Order控制器（管理端）

- [ ] **接口开发**
  - [ ] POST /api/order/create - 创建订单（普通用户）
  - [ ] GET /api/order/list - 我的订单列表（所有用户，内容按角色区分）
  - [ ] GET /api/order/info/{id} - 订单详情（所有用户，操作按角色区分）
  - [ ] POST /api/order/cancel - 取消订单（普通用户）
  - [ ] POST /api/order/refund - 申请退款（普通用户）
  - [ ] POST /api/order/approve - 同意订单（主持人）
  - [ ] POST /api/order/reject - 拒绝订单（主持人）
  - [ ] POST /api/order/complete - 确认完成（主持人）
  - [ ] POST /api/order/uploadPaymentVoucher - 上传付款凭证（普通用户）
  - [ ] GET /admin/order/list - 订单列表（管理端）
  - [ ] POST /admin/order/confirmPayment - 确认付款（管理端）
  - [ ] POST /admin/order/confirmRefund - 确认退款（管理端）
  - [ ] GET /admin/order/timeoutConfig - 获取超时配置（管理端）
  - [ ] POST /admin/order/timeoutConfig - 保存超时配置（管理端）
  - [ ] GET /admin/order/timeoutLog - 获取超时日志（管理端）

- [ ] **业务逻辑**
  - [ ] 档期锁定逻辑
  - [ ] 订单金额计算
  - [ ] 状态流转逻辑
  - [ ] 状态日志记录

**验收标准**:
- 订单创建流程正常
- 订单状态流转正常
- 档期锁定/释放正常
- 付款/退款确认正常

---

## 五、第3阶段：扩展功能（第3周）

### 5.1 Day 11-12：评价模块

**任务清单**:

- [ ] **后端服务层**
  - [ ] ReviewService服务类
    - [ ] add方法（提交评价）
    - [ ] getList方法（评价列表）
    - [ ] reply方法（回复评价）
    - [ ] getStatistics方法（评价统计）

- [ ] **后端控制器**
  - [ ] API：Review控制器（统一接口，通过角色权限中间件区分）
  - [ ] Admin：Review控制器（管理端）

- [ ] **接口开发**
  - [ ] POST /api/review/add - 提交评价（普通用户）
  - [ ] GET /api/review/list - 评价列表（所有用户）
  - [ ] POST /api/review/reply - 回复评价（主持人）
  - [ ] GET /api/review/myList - 我的评价列表（主持人）
  - [ ] GET /admin/review/list - 评价管理（管理端）
  - [ ] POST /admin/review/audit - 审核评价（管理端）

**验收标准**:
- 评价提交功能正常
- 评价列表显示正常
- 回复功能正常

### 5.2 Day 13-14：动态模块

**任务清单**:

- [ ] **后端服务层**
  - [ ] DynamicService服务类
  - [ ] DynamicCommentService服务类
  - [ ] DynamicCategoryService服务类

- [ ] **后端控制器**
  - [ ] API：Dynamic控制器（统一接口，通过角色权限中间件区分）
  - [ ] Admin：Dynamic控制器（管理端）

- [ ] **接口开发**
  - [ ] GET /api/dynamic/list - 动态列表（所有用户）
  - [ ] GET /api/dynamic/info/{id} - 动态详情（所有用户）
  - [ ] POST /api/dynamic/like - 点赞（所有用户）
  - [ ] GET /api/dynamic/comments - 评论列表（所有用户）
  - [ ] POST /api/dynamic/comment - 发表评论（所有用户）
  - [ ] POST /api/dynamic/publish - 发布动态（主持人）
  - [ ] GET /api/dynamic/myList - 我的动态（主持人）
  - [ ] POST /api/dynamic/delete - 删除动态（主持人）
  - [ ] GET /admin/dynamic/list - 动态管理（管理端）
  - [ ] POST /admin/dynamic/audit - 审核动态（管理端）

**验收标准**:
- 动态发布功能正常
- 点赞评论功能正常
- 审核功能正常

### 5.3 Day 15：退款与配置模块

**任务清单**:

- [ ] **退款模块**
  - [ ] RefundApplyService服务类
  - [ ] 退款申请接口
  - [ ] 退款审核接口
  - [ ] 退款列表接口

- [ ] **配置模块**
  - [ ] ConfigService服务类
  - [ ] 配置获取接口
  - [ ] 配置保存接口

- [ ] **统计模块**
  - [ ] StatisticsService服务类
  - [ ] 仪表盘数据接口
  - [ ] 主持人工作台数据接口
  - [ ] 订单统计接口
  - [ ] 主持人统计接口
  - [ ] 会员统计接口

- [ ] **消息模块**
  - [ ] MessageService服务类
  - [ ] MessageReadService服务类
  - [ ] 消息列表接口
  - [ ] 标记已读接口
  - [ ] 未读消息数接口
  - [ ] 消息推送逻辑

- [ ] **内容管理模块**
  - [ ] NoticeService服务类（公告）
  - [ ] BannerService服务类（轮播图）
  - [ ] 公告管理接口（CRUD）
  - [ ] 轮播图管理接口（CRUD）

- [ ] **分享模块**
  - [ ] ShareService服务类
  - [ ] 分享记录接口
  - [ ] 分享数据接口

- [ ] **订单超时处理**
  - [ ] OrderTimeoutJob定时任务
  - [ ] 超时配置接口
  - [ ] 超时日志接口

**验收标准**:
- 退款流程正常
- 配置管理正常
- 统计数据正确
- 消息推送正常
- 内容管理正常
- 分享功能正常
- 订单超时处理正常

---

## 六、第4阶段：前端开发（第4周）

### 6.1 Day 16-19：小程序开发（统一应用，按角色区分）

**任务清单**:

- [ ] **公共组件**
  - [ ] host-card 主持人卡片
  - [ ] order-card 订单卡片
  - [ ] dynamic-card 动态卡片
  - [ ] date-picker 日期选择器
  - [ ] period-picker 场次选择器
  - [ ] empty-state 空状态
  - [ ] loading 加载组件
  - [ ] message-badge 消息角标
  - [ ] share-button 分享按钮

- [ ] **工具函数**
  - [ ] useAuth Hook（认证，包含角色判断）
  - [ ] useRole Hook（角色权限判断）
  - [ ] useMessage Hook（消息处理）
  - [ ] useShare Hook（分享处理）
  - [ ] 路由守卫（按角色控制页面访问）

- [ ] **页面开发（所有用户）**
  - [ ] 首页 (index)
  - [ ] 主持人列表页
  - [ ] 主持人详情页（含分享功能）
  - [ ] 档期选择页
  - [ ] 动态列表页
  - [ ] 动态详情页（含分享功能）
  - [ ] 消息中心页
  - [ ] 登录页

- [ ] **页面开发（普通用户）**
  - [ ] 订单创建页
  - [ ] 订单列表页（用户视角）
  - [ ] 订单详情页（用户视角，含上传付款凭证、分享功能）
  - [ ] 评价提交页
  - [ ] 我的收藏页

- [ ] **页面开发（主持人）**
  - [ ] 工作台首页
  - [ ] 订单列表页（主持人视角）
  - [ ] 订单详情页（主持人视角，含审核操作）
  - [ ] 档期日历页
  - [ ] 档期设置页
  - [ ] 动态管理页
  - [ ] 发布动态页
  - [ ] 评价管理页（回复评价）
  - [ ] 个人资料页

- [ ] **个人中心（按角色显示）**
  - [ ] 个人中心首页（根据角色显示不同菜单，含消息角标）
  - [ ] 普通用户：我的订单、我的收藏、我的评价、消息中心
  - [ ] 服务提供者：工作台、我的订单、档期管理、动态管理、评价管理、消息中心
  - [ ] 客服入口（调用微信小程序客服）

**验收标准**:
- 所有页面正常显示
- 角色判断正确，功能按角色区分
- 路由守卫正常工作
- 交互流程顺畅
- 数据加载正常

### 6.2 Day 20-21：管理端开发

**任务清单**:

- [ ] **布局组件**
  - [ ] 侧边栏菜单
  - [ ] 顶部导航
  - [ ] 面包屑

- [ ] **页面开发**
  - [ ] 登录页
  - [ ] 仪表盘页（数据统计）
  - [ ] 主持人列表页
  - [ ] 主持人详情页
  - [ ] 标签管理页
  - [ ] 订单列表页
  - [ ] 订单详情页（含付款确认、查看用户上传凭证）
  - [ ] 退款管理页
  - [ ] 评价管理页
  - [ ] 动态管理页
  - [ ] 系统配置页
  - [ ] 消息管理页
  - [ ] 公告管理页
  - [ ] 轮播图管理页
  - [ ] 订单超时配置页
  - [ ] 数据统计页（订单统计、主持人统计、会员统计）

- [ ] **DIY装修功能开发**
  - [ ] 安装拖拽库（vuedraggable或sortablejs）
  - [ ] 装修编辑器页面
    - [ ] 左侧组件库面板
    - [ ] 中间画布区域（可拖拽）
    - [ ] 右侧属性配置面板
  - [ ] 组件管理
    - [ ] 组件拖拽添加
    - [ ] 组件排序调整
    - [ ] 组件删除
    - [ ] 组件复制
  - [ ] 组件配置
    - [ ] 动态表单生成
    - [ ] 样式配置
    - [ ] 数据绑定
  - [ ] 实时预览
    - [ ] 预览窗口
    - [ ] 移动端预览
  - [ ] 页面管理
    - [ ] 创建页面
    - [ ] 编辑页面
    - [ ] 删除页面
    - [ ] 切换页面
    - [ ] 应用模板

**验收标准**:
- 登录功能正常
- 数据列表正常
- 操作功能正常
- DIY装修功能可用
- 拖拽排序正常
- 组件配置保存正常

---

## 七、第5阶段：测试上线（第5周）

### 7.1 Day 21-22：功能测试

**任务清单**:

- [ ] **用户端测试**
  - [ ] 登录授权测试
  - [ ] 主持人浏览测试
  - [ ] 订单创建测试
  - [ ] 订单取消测试
  - [ ] 评价提交测试
  - [ ] 动态互动测试

- [ ] **主持人端测试**
  - [ ] 订单审核测试
  - [ ] 档期管理测试
  - [ ] 动态发布测试
  - [ ] 评价回复测试

- [ ] **管理端测试**
  - [ ] 主持人管理测试
  - [ ] 订单管理测试
  - [ ] 付款确认测试
  - [ ] 退款处理测试
  - [ ] 审核功能测试

**验收标准**:
- 所有功能正常
- 无严重Bug

### 7.2 Day 23-24：优化与修复

**任务清单**:

- [ ] **Bug修复**
  - [ ] 修复测试发现的问题
  - [ ] 处理边界情况

- [ ] **性能优化**
  - [ ] 接口响应优化
  - [ ] 数据库查询优化
  - [ ] 缓存策略实施

- [ ] **体验优化**
  - [ ] 加载状态优化
  - [ ] 错误提示优化
  - [ ] 交互细节优化

**验收标准**:
- 接口响应时间 < 500ms
- 无明显卡顿

### 7.3 Day 25：部署上线

**任务清单**:

- [ ] **服务器部署**
  - [ ] 配置Nginx
  - [ ] 部署后端代码
  - [ ] 配置SSL证书
  - [ ] 配置环境变量

- [ ] **小程序发布**
  - [ ] 构建生产版本
  - [ ] 上传到微信平台
  - [ ] 提交审核

- [ ] **管理端部署**
  - [ ] 构建生产版本
  - [ ] 部署到服务器

- [ ] **最终验收**
  - [ ] 生产环境测试
  - [ ] 数据备份策略
  - [ ] 监控告警配置

**验收标准**:
- 服务稳定运行
- 小程序审核通过

---

## 八、任务分配

### 8.1 角色分工

| 角色 | 职责 |
|-----|------|
| 后端开发 | 数据库设计、API开发、业务逻辑 |
| 前端开发 | 小程序开发、管理端开发 |
| 测试 | 功能测试、Bug反馈 |
| 产品 | 需求确认、验收把关 |

### 8.2 并行任务

**可并行开发**:
- 后端API开发 与 前端页面框架搭建
- 主持人模块 与 动态模块
- 小程序开发 与 管理端开发

**需串行开发**:
- 数据库 → 模型层 → 服务层 → 控制器
- 基础组件 → 页面开发 → 功能联调

---

## 九、风险管理

### 9.1 风险清单

| 风险项 | 等级 | 应对措施 |
|-------|------|---------|
| 需求变更 | 中 | 提前确认需求，设置变更流程 |
| 技术难点 | 低 | 技术方案预研，及时沟通 |
| 进度延期 | 中 | 设置里程碑，定期检查进度 |
| 人员变动 | 低 | 代码规范，文档完善 |
| 微信审核 | 中 | 预留审核时间，准备备用方案 |

### 9.2 应对策略

**进度管理**:
- 每日站会同步进度
- 每周周报总结问题
- 遇到阻塞及时上报

**质量保证**:
- 代码Review
- 单元测试
- 集成测试

---

## 十、交付物清单

### 10.1 代码交付

| 交付物 | 说明 |
|-------|------|
| Wedding-management-api | 后端API代码 |
| Wedding-management-miniapp | 小程序代码 |
| Wedding-management-admin | 管理端代码 |

### 10.2 文档交付

| 交付物 | 说明 |
|-------|------|
| 项目开发文档 | 技术架构、开发规范 |
| 数据库设计文档 | 表结构、字段说明 |
| API接口文档 | 接口列表、参数说明 |
| 业务流程文档 | 业务流程、状态说明 |
| 部署文档 | 部署步骤、配置说明 |
| 操作手册 | 功能使用说明 |

### 10.3 部署交付

| 交付物 | 说明 |
|-------|------|
| 生产环境 | 服务器部署完成 |
| 小程序上架 | 审核通过可使用 |
| 管理端上线 | 可正常访问 |

---

## 十一、里程碑节点

| 日期 | 里程碑 | 验收内容 |
|-----|-------|---------|
| Week 1 结束 | M1: 基础搭建完成 | 环境可用，数据库就绪 |
| Week 2 结束 | M2: 核心功能完成 | 主持人、订单功能可用 |
| Week 3 结束 | M3: 扩展功能完成 | 评价、动态、退款功能可用 |
| Week 4 结束 | M4: 前端开发完成 | 小程序、管理端可用 |
| Week 5 结束 | M5: 项目上线 | 生产环境可用 |

---

## 十二、后续规划

### 12.1 V1.1 版本规划（可选）

- 消息推送优化
- 数据统计增强
- 性能监控接入
- 用户行为分析

### 12.2 V2.0 版本规划（可选）

- 在线咨询功能
- 优惠券/活动功能
- 会员等级体系
- 分销推广功能

---

**文档版本**: v1.0.0  
**最后更新**: 2025-12-31

